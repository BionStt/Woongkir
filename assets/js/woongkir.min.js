!function(i,e){"use strict";function n(){var i=e.store.get(woongkir_params.json.province_key);return void 0!==i&&"undefined"!=i&&i?i:[]}function t(){var i=e.store.get(woongkir_params.json.city_key);return void 0!==i&&"undefined"!=i&&i?i:[]}function o(){var i=e.store.get(woongkir_params.json.subdistrict_key);return void 0!==i&&"undefined"!=i&&i?i:[]}function r(){var e=n(),r=t(),c=(o(),i(".woongkir-account-type").closest("form"));if(c.find(".woongkir-account-type").bind("change",function(e){var n=i(e.currentTarget).val(),t=i(e.currentTarget).data("accounts"),o=i(e.currentTarget).data("couriers");for(var r in o){i("#woongkir-couriers-list-"+r).hide();var c=0;for(var a in o[r])-1===o[r][a].account.indexOf(n)?i("#woongkir-courier-box-"+r+"-"+a).hide().find(".woongkir-service").prop("checked",!1):(i("#woongkir-couriers-list-"+r).show(),i("#woongkir-courier-box-"+r+"-"+a).show()),t[n].multiple||(c&&i("#woongkir-courier-box-"+r+"-"+a).find(".woongkir-service").prop("checked",!1),i("#woongkir-courier-box-"+r+"-"+a).find(".woongkir-service.single:checked").length&&c++)}}),c.find(".woongkir-service.bulk").bind("change",function(e){var n=i(this).closest("table"),t=(i(this).closest(".woongkir-couriers-list").data("id"),i(this).closest(".woongkir-courier-box").data("id")),o=c.find(".woongkir-account-type").val(),r=c.find(".woongkir-account-type").data("accounts");c.find(".woongkir-account-type").data("couriers");this.checked?(n.find(".woongkir-service.single").prop("checked",!0),r[o].multiple||c.find(".woongkir-courier-box").not("."+t).find(".woongkir-service").prop("checked",!1)):n.find(".woongkir-service.single").prop("checked",!1)}),c.find(".woongkir-service.single").bind("change",function(e){var n=i(this).closest("table"),t=(i(this).closest(".woongkir-couriers-list").data("id"),i(this).closest(".woongkir-courier-box").data("id")),o=c.find(".woongkir-account-type").val(),r=c.find(".woongkir-account-type").data("accounts");c.find(".woongkir-account-type").data("couriers");this.checked?(n.find(".woongkir-service.bulk").prop({checked:!0}),r[o].multiple||c.find(".woongkir-courier-box").not("."+t).find(".woongkir-service").prop("checked",!1)):n.find(".woongkir-service.single:checked").length||n.find(".woongkir-service.bulk").prop({checked:!1})}),c.find(".woongkir-account-type").trigger("change"),c.find(".woongkir-origin-province-select").empty().append('<option value="">'+woongkir_params.text.select_province+"</option>"),e.length){var a=c.find(".woongkir-origin-province").val();i.each(e,function(i,e){var n='<option value="'+e.province_id+'"';a==e.province_id&&(n+=" selected"),n+=">"+e.province,n+="</option>",c.find(".woongkir-origin-province-select").append(n)})}c.find(".woongkir-origin-province-select").bind("change",function(e){if(c.find(".woongkir-origin-province").val(i(e.currentTarget).val()),c.find(".woongkir-origin-city-select").empty().append('<option value="">'+woongkir_params.text.select_city+"</option>"),r.length){var n=c.find(".woongkir-origin-city").val();i.each(r,function(t,o){if(o.province_id==i(e.currentTarget).val()){var r='<option value="'+o.city_id+'"';n==o.city_id&&(r+=" selected"),r+=">",r+=o.type+" ",r+=o.city_name,r+="</option>",c.find(".woongkir-origin-city-select").append(r)}}),c.find(".woongkir-origin-city-select").trigger("change")}}),c.find(".woongkir-origin-city-select").bind("change",function(e){c.find(".woongkir-origin-city").val(i(e.currentTarget).val()),c.find(".woongkir-origin-subdistrict-select").empty().append('<option value="">'+woongkir_params.text.select_subdistrict+"</option>");var n=o();if(n.length){var t=c.find(".woongkir-origin-subdistrict").val();i.each(n,function(n,o){if(o.city_id==i(e.currentTarget).val()){var r='<option value="'+o.subdistrict_id+'"';t==o.subdistrict_id&&(r+=" selected"),r+=">"+o.subdistrict_name,r+="</option>",c.find(".woongkir-origin-subdistrict-select").append(r)}}),c.find(".woongkir-origin-subdistrict-select").trigger("change")}}),c.find(".woongkir-origin-subdistrict-select").bind("change",function(e){c.find(".woongkir-origin-subdistrict").val(i(e.currentTarget).val())}),c.find(".woongkir-origin-province-select").trigger("change")}n().length||i.getJSON(woongkir_params.json.province_url,function(i){i.sort(function(i,e){return i.province_name>e.province_name?1:e.province_name>i.province_name?-1:0}),e.store.set(woongkir_params.json.province_key,i)}),t().length||i.getJSON(woongkir_params.json.city_url,function(i){i.sort(function(i,e){return i.city_name>e.city_name?1:e.city_name>i.city_name?-1:0}),e.store.set(woongkir_params.json.city_key,i)}),o().length||i.getJSON(woongkir_params.json.subdistrict_url,function(i){i.sort(function(i,e){return i.subdistrict_name>e.subdistrict_name?1:e.subdistrict_name>i.subdistrict_name?-1:0}),e.store.set(woongkir_params.json.subdistrict_key,i)}),i(document).ready(function(){i(document.body).on("country_to_state_changed",function(e,r,c){!function(e,r){if(void 0!==e&&"undefined"!=e&&e&&void 0!==r&&"undefined"!=r&&r){var c=r.find("#billing_state, #shipping_state, #calc_shipping_state"),a=r.find("#billing_city, #shipping_city, #calc_shipping_city"),s=a.parent(),d=a.val(),p=a.attr("name"),g=a.attr("id"),l=a.attr("placeholder")||a.attr("data-placeholder")||"",u=r.find("#billing_address_2, #shipping_address_2"),_=u.parent(),f=u.val(),h=u.attr("name"),k=u.attr("id"),v=u.attr("placeholder")||u.attr("data-placeholder")||"";"ID"===e?(c.bind("change",function(){a.unbind("change"),a.is("input")&&(a.replaceWith('<select name="'+p+'" id="'+g+'" class="city_select" data-placeholder="'+woongkir_params.text.select_city+'"></select>'),a=r.find("#billing_city, #shipping_city, #calc_shipping_city")),a.empty().append('<option value="">'+woongkir_params.text.select_city+"</option>");var e=c.val(),s=0,l=n();l&&i.each(l,function(i,n){n.code!=e||(s=n.province_id)});var _=t(),v="";_&&i.each(_,function(i,e){if(e.province_id==s){var n=(v=e.type+" "+e.city_name)===d?" selected":"";a.append('<option value="'+v+'" '+n+">"+v+"</option>")}}),i().select2&&a.select2({placeholderOption:"first",placeholder:woongkir_params.text.select_city,width:"100%"}),a.bind("change",function(){if(u.length){u.is("input")&&(u.replaceWith('<select name="'+h+'" id="'+k+'" class="subdistrict_select" data-placeholder="'+woongkir_params.text.select_subdistrict+'"></select>'),u=r.find("#billing_address_2, #shipping_address_2")),u.empty().append('<option value="">'+woongkir_params.text.select_subdistrict+"</option>");var e=0,n=t();if(n&&i.each(n,function(i,n){n.type+" "+n.city_name!=a.val()||(e=n.city_id)}),e){var c=o();c&&i.each(c,function(i,n){if(n.city_id==e){var t=n.subdistrict_name===f?" selected":"";u.append('<option value="'+n.subdistrict_name+'" '+t+">"+n.subdistrict_name+"</option>")}})}i().select2&&u.select2({placeholderOption:"first",placeholder:woongkir_params.text.select_subdistrict,width:"100%"})}}),i(function(){a.change()})}),i(function(){c.change()})):(a.is("select")&&(s.show().find(".select2-container").remove(),a.replaceWith('<input type="text" class="input-text" name="'+p+'" id="'+g+'" placeholder="'+l+'" />'),a=r.find("#billing_city, #shipping_city, #calc_shipping_city")),u.is("select")&&(_.show().find(".select2-container").remove(),u.replaceWith('<input type="text" class="input-text" name="'+h+'" id="'+k+'" placeholder="'+v+'" />'),u=r.find("#billing_address_2, #shipping_address_2")))}}(r,c)}),i(document.body).on("updated_wc_div",function(e){i(":input.country_to_state").change()}),i(document.body).on("updated_shipping_method",function(e){i(":input.country_to_state").change()}),i(document).on("click",".wc-shipping-zone-method-settings",r),woongkir_params.show_settings&&setTimeout(function(){for(var e=!1,n=i(document).find(".wc-shipping-zone-method-title > a.wc-shipping-zone-method-settings"),t=0;t<n.length;t++){var o=n[t];if("Woongkir"==i(o).text())return i(o).trigger("click"),void(e=!0)}e||i(document).find(".wc-shipping-zone-add-method").trigger("click")},300)})}(jQuery,window);